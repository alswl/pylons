<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Helpers &mdash; Pylons Framework 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Pylons Framework 1.1 documentation" href="index.html" />
    <link rel="next" title="Forms" href="forms.html" />
    <link rel="prev" title="Logging" href="logging.html" />
<link rel="stylesheet" href="http://static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="_static/pylons.ico"/>

  </head>
  <body role="document">







<div class="header-small">
	
	<div class="logo-small">
		<a href="index.html">
      		<img class="logo" src="_static/pylonsfw-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="forms.html" title="Forms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="logging.html" title="Logging"
             accesskey="P">previous</a> |</li>
    	<li><a href="index.html">Pylons Framework 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="helpers">
<span id="id1"></span><h1>Helpers<a class="headerlink" href="#helpers" title="Permalink to this headline">¶</a></h1>
<p>Helpers are functions intended for usage in templates, to assist with common
HTML and text manipulation, higher level constructs like a HTML
tag builder (that safely escapes variables), and advanced functionality
like Pagination of data sets.</p>
<p>The majority of the helpers available in Pylons are provided by the
<code class="xref py py-mod docutils literal"><span class="pre">webhelpers</span></code> package. Some of these helpers are also used in controllers
to prepare data for use in the template by other helpers, such as the
<code class="xref py py-func docutils literal"><span class="pre">secure_form_tag()</span></code> function which has a corresponding
<code class="xref py py-func docutils literal"><span class="pre">authenticate_form()</span></code>.</p>
<p>To make individual helpers available for use in templates under <a class="reference internal" href="glossary.html#term-h"><span class="xref std std-term">h</span></a>, the
appropriate functions need to be imported in <code class="file docutils literal"><span class="pre">lib/helpers.py</span></code>. All the
functions available in this file are then available under <a class="reference internal" href="glossary.html#term-h"><span class="xref std std-term">h</span></a> just like
any other module reference.</p>
<p>By customizing the <code class="file docutils literal"><span class="pre">lib/helpers.py</span></code> module you can quickly add custom
functions and classes for use in your templates.</p>
<p>Helper functions are organized into modules by theme. All HTML generators are under the <code class="docutils literal"><span class="pre">webhelpers_html</span></code> package, except for a few third-party modules which are directly under <code class="docutils literal"><span class="pre">webhelpers</span></code>. The webhelpers modules are separately documented, see <code class="xref py py-mod docutils literal"><span class="pre">webhelpers</span></code>.</p>
<div class="section" id="pagination">
<span id="id2"></span><h2>Pagination<a class="headerlink" href="#pagination" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <cite>paginate</cite> module is not compatible to the deprecated <cite>pagination</cite>
module that was provided with former versions of the Webhelpers package.</p>
</div>
<div class="section" id="purpose-of-a-paginator">
<h3>Purpose of a paginator<a class="headerlink" href="#purpose-of-a-paginator" title="Permalink to this headline">¶</a></h3>
<p>When you display large amounts of data like a result from an SQL query then
usually you cannot display all the results on a single page. It would simply be
too much. So you divide the data into smaller chunks. This is what a paginator
does. It shows one page of chunk of data at a time. Imagine you are providing a
company phonebook through the web and let the user search the entries. Assume
the search result contains 23 entries. You may decide to display no more than 10
entries per page. The first page contains entries 1-10, the second 11-20 and the
third 21-23. And you also show a navigational element like
<code class="docutils literal"><span class="pre">Page</span> <span class="pre">1</span> <span class="pre">of</span> <span class="pre">3:</span> <span class="pre">[1]</span> <span class="pre">2</span> <span class="pre">3</span></code> that allows the user to switch between the available
pages.</p>
</div>
<div class="section" id="the-page-class">
<h3>The <code class="docutils literal"><span class="pre">Page</span></code> class<a class="headerlink" href="#the-page-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-mod docutils literal"><span class="pre">webhelpers</span></code> package provides a <em>paginate</em> module that can be used
for this purpose. It can create pages from simple Python lists as well as
SQLAlchemy queries and SQLAlchemy select objects. The module provides a <code class="docutils literal"><span class="pre">Page</span></code>
object that represents a single page of items from a larger result set. Such a
<code class="docutils literal"><span class="pre">Page</span></code> mainly behaves like a list of items on that page. Let&#8217;s take the above
example of 23 items spread across 3 pages:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="go"># Create a list of items from 1 to 23</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">items</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>

<span class="go"># Import the paginate module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">webhelpers.paginate</span>

<span class="go"># Create a Page object from the &#39;items&#39; for the second page</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page2</span> <span class="o">=</span> <span class="n">webhelpers</span><span class="o">.</span><span class="n">paginate</span><span class="o">.</span><span class="n">Page</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">items_per_page</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="go"># The Page object can be printed (__repr__) to show details on the page</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page2</span>

<span class="go">    Page:</span>
<span class="go">    Collection type:  &lt;type &#39;list&#39;&gt;</span>
<span class="go">    (Current) page:   2</span>
<span class="go">    First item:       11</span>
<span class="go">    Last item:        20</span>
<span class="go">    First page:       1</span>
<span class="go">    Last page:        3</span>
<span class="go">    Previous page:    1</span>
<span class="go">    Next page:        3</span>
<span class="go">    Items per page:   10</span>
<span class="go">    Number of items:  23</span>
<span class="go">    Number of pages:  3</span>

<span class="go"># Show the items on this page</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">page2</span><span class="p">)</span>

<span class="go">    [11, 12, 13, 14, 15, 16, 17, 18, 19, 20]</span>

<span class="go"># Print the items in a for loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">page2</span><span class="p">:</span> <span class="k">print</span> <span class="s">&quot;This is entry&quot;</span><span class="p">,</span> <span class="n">i</span>

<span class="go">    This is entry 11</span>
<span class="go">    This is entry 12</span>
<span class="go">    This is entry 13</span>
<span class="go">    This is entry 14</span>
<span class="go">    This is entry 15</span>
<span class="go">    This is entry 16</span>
<span class="go">    This is entry 17</span>
<span class="go">    This is entry 18</span>
<span class="go">    This is entry 19</span>
<span class="go">    This is entry 20</span>
</pre></div>
</div>
<p>There are further parameters to invoking a <code class="docutils literal"><span class="pre">Page</span></code> object. Please see
<a class="reference external" href="http://sluggo.scrapping.cc/python/WebHelpers/modules/paginate.html#webhelpers.paginate.Page" title="(in WebHelpers v1.3)"><code class="xref py py-class docutils literal"><span class="pre">webhelpers.paginate.Page</span></code></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Page numbers and item numbers start from 1. If you are accessing the
items on the page by their index please note that the first item is
<code class="docutils literal"><span class="pre">item[1]</span></code> instead of <code class="docutils literal"><span class="pre">item[0]</span></code>.</p>
</div>
</div>
<div class="section" id="switching-between-pages-using-a-pager">
<h3>Switching between pages using a <cite>pager</cite><a class="headerlink" href="#switching-between-pages-using-a-pager" title="Permalink to this headline">¶</a></h3>
<p>The user needs a way to get to another page. This is usually done with a list
of links like <code class="docutils literal"><span class="pre">Page</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">41</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">[3]</span> <span class="pre">4</span> <span class="pre">5</span> <span class="pre">..</span> <span class="pre">41</span></code>. Such a list can be
created by the Page&#8217;s <a class="reference external" href="http://sluggo.scrapping.cc/python/WebHelpers/modules/paginate.html#webhelpers.paginate.Page.pager" title="(in WebHelpers v1.3)"><code class="xref py py-meth docutils literal"><span class="pre">pager()</span></code></a> method.
Take the above example again:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">page2</span><span class="o">.</span><span class="n">pager</span><span class="p">()</span>

<span class="go">    &lt;a class=&quot;pager_link&quot; href=&quot;/content?page=1&quot;&gt;1&lt;/a&gt;</span>
<span class="go">    &lt;span class=&quot;pager_curpage&quot;&gt;2&lt;/span&gt;</span>
<span class="go">    &lt;a class=&quot;pager_link&quot; href=&quot;/content?page=3&quot;&gt;3&lt;/a&gt;</span>
</pre></div>
</div>
<p>Without the HTML tags it looks like <code class="docutils literal"><span class="pre">1</span> <span class="pre">[2]</span> <span class="pre">3</span></code>. The links point to a URL
where the respective page is found. And the current page (2) is highlighted.</p>
<p>The appearance of a pager can be customized. By default the format string
is <code class="docutils literal"><span class="pre">~2~</span></code> which means it shows adjacent pages from the current page with
a maximal radius of 2. In a larger set this would look like
<code class="docutils literal"><span class="pre">1</span> <span class="pre">..</span> <span class="pre">34</span> <span class="pre">35</span> <span class="pre">[36]</span> <span class="pre">37</span> <span class="pre">38</span> <span class="pre">..</span> <span class="pre">176</span></code>. The radius of 2 means that two pages before
and after the current page 36 are shown.</p>
<p>Several special variables can be used in the format string. See
<a class="reference external" href="http://sluggo.scrapping.cc/python/WebHelpers/modules/paginate.html#webhelpers.paginate.Page.pager" title="(in WebHelpers v1.3)"><code class="xref py py-meth docutils literal"><span class="pre">pager()</span></code></a> for a complete list. Some examples
for a pager of 20 pages while being on page 10 currently:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">pager</span><span class="p">()</span>

<span class="go">    1 .. 8 9 [10] 11 12 .. 20</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">pager</span><span class="p">(</span><span class="s">&#39;~4~&#39;</span><span class="p">)</span>

<span class="go">    1 .. 6 7 8 9 [10] 11 12 13 14 .. 20</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">pager</span><span class="p">(</span><span class="s">&#39;Page $page of $page_count - ~3~&#39;</span><span class="p">)</span>

<span class="go">    Page 10 of 20 - 1 .. 7 8 9 [10] 11 12 13 .. 20</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">pager</span><span class="p">(</span><span class="s">&#39;$link_previous $link_next ~2~&#39;</span><span class="p">)</span>

<span class="go">    &lt; &gt; 1 .. 8 9 [10] 11 12 .. 20</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">pager</span><span class="p">(</span><span class="s">&#39;Items $first_item - $last_item / ~2~&#39;</span><span class="p">)</span>

<span class="go">    Items 91 - 100 / 1 .. 8 9 [10] 11 12 .. 20</span>
</pre></div>
</div>
</div>
<div class="section" id="paging-over-an-sqlalchemy-query">
<h3>Paging over an SQLAlchemy query<a class="headerlink" href="#paging-over-an-sqlalchemy-query" title="Permalink to this headline">¶</a></h3>
<p>If the data to page over comes from a database via SQLAlchemy then the
<code class="docutils literal"><span class="pre">paginate</span></code> module can access a <code class="docutils literal"><span class="pre">query</span></code> object directly. This is useful
when using ORM-mapped models. Example:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">employee_query</span> <span class="o">=</span> <span class="n">Session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Employee</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page2</span> <span class="o">=</span> <span class="n">webhelpers</span><span class="o">.</span><span class="n">paginate</span><span class="o">.</span><span class="n">Page</span><span class="p">(</span>
<span class="go">        employee_query,</span>
<span class="go">        page=2,</span>
<span class="go">        items_per_page=10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">employee</span> <span class="ow">in</span> <span class="n">page2</span><span class="p">:</span> <span class="k">print</span> <span class="n">employee</span><span class="o">.</span><span class="n">first_name</span>

<span class="go">    John</span>
<span class="go">    Jack</span>
<span class="go">    Joseph</span>
<span class="go">    Kay</span>
<span class="go">    Lars</span>
<span class="go">    Lynn</span>
<span class="go">    Pamela</span>
<span class="go">    Sandra</span>
<span class="go">    Thomas</span>
<span class="go">    Tim</span>
</pre></div>
</div>
<p>The <cite>paginate</cite> module is smart enough to only query the database for the
objects that are needed on this page. E.g. if a page consists of the items
11-20 then SQLAlchemy will be asked to fetch exactly that 10 rows
through <cite>LIMIT</cite> and <cite>OFFSET</cite> in the actual SQL query. So you must not load
the complete result set into memory and pass that. Instead always pass
a <cite>query</cite> when creating a <cite>Page</cite>.</p>
</div>
<div class="section" id="paging-over-an-sqlalchemy-select">
<h3>Paging over an SQLAlchemy select<a class="headerlink" href="#paging-over-an-sqlalchemy-select" title="Permalink to this headline">¶</a></h3>
<p>SQLAlchemy also allows to run arbitrary SELECTs on database tables.
This is useful for non-ORM queries. <cite>paginate</cite> can use such select
objects, too. Example:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">selection</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">Employee</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">first_name</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page2</span> <span class="o">=</span> <span class="n">webhelpers</span><span class="o">.</span><span class="n">paginate</span><span class="o">.</span><span class="n">Page</span><span class="p">(</span>
<span class="go">        selection,</span>
<span class="go">        page=2,</span>
<span class="go">        items_per_page=10,</span>
<span class="go">        sqlalchemy_session=model.Session)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">first_name</span> <span class="ow">in</span> <span class="n">page2</span><span class="p">:</span> <span class="k">print</span> <span class="n">first_name</span>

<span class="go">    John</span>
<span class="go">    Jack</span>
<span class="go">    Joseph</span>
<span class="go">    Kay</span>
<span class="go">    Lars</span>
<span class="go">    Lynn</span>
<span class="go">    Pamela</span>
<span class="go">    Sandra</span>
<span class="go">    Thomas</span>
<span class="go">    Tim</span>
</pre></div>
</div>
<p>The only difference to using SQLAlchemy <em>query</em> objects is that you need to
pass an SQLAlchemy <em>session</em> via the <code class="docutils literal"><span class="pre">sqlalchemy_session</span></code> parameter.
A bare <code class="docutils literal"><span class="pre">select</span></code> does not have a database connection assigned. But the session
has.</p>
</div>
<div class="section" id="usage-in-a-pylons-controller-and-template">
<h3>Usage in a Pylons controller and template<a class="headerlink" href="#usage-in-a-pylons-controller-and-template" title="Permalink to this headline">¶</a></h3>
<p>A simple example to begin with.</p>
<p>Controller:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">c</span><span class="o">.</span><span class="n">employees</span> <span class="o">=</span> <span class="n">webhelpers</span><span class="o">.</span><span class="n">paginate</span><span class="o">.</span><span class="n">Page</span><span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Employee</span><span class="p">),</span>
        <span class="n">page</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&#39;page&#39;</span><span class="p">]),</span>
        <span class="n">items_per_page</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="s">&#39;/employees/list.mako&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Template:</p>
<div class="highlight-mako"><div class="highlight"><pre><span class="cp">${</span><span class="n">c</span><span class="o">.</span><span class="n">employees</span><span class="o">.</span><span class="n">pager</span><span class="p">(</span><span class="s">&#39;Page $page: $link_previous $link_next ~4~&#39;</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">&lt;ul&gt;</span>
<span class="cp">%</span> <span class="k">for</span> <span class="n">employee</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">employees</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;li&gt;</span><span class="cp">${</span><span class="n">employee</span><span class="o">.</span><span class="n">first_name</span><span class="cp">}</span><span class="x"> </span><span class="cp">${</span><span class="n">employee</span><span class="o">.</span><span class="n">last_name</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
<span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">&lt;/ul&gt;</span>
</pre></div>
</div>
<p>The <cite>pager()</cite> creates links to the previous URL and just sets the
<em>page</em> parameter appropriately. That&#8217;s why you need to pass the requested page
number (<code class="docutils literal"><span class="pre">request.params['page']</span></code>) when you create a <cite>Page</cite>.</p>
</div>
<div class="section" id="partial-updates-with-ajax">
<h3>Partial updates with AJAX<a class="headerlink" href="#partial-updates-with-ajax" title="Permalink to this headline">¶</a></h3>
<p>Updating a page partially is easy. All it takes is a little Javascript
that - instead of loading the complete page - updates just the part
of the page containing the paginated items. The <code class="docutils literal"><span class="pre">pager()</span></code> method accepts an
<code class="docutils literal"><span class="pre">onclick</span></code> parameter for that purpose. This value is added as an <code class="docutils literal"><span class="pre">onclick</span></code>
parameter to the A-HREF tags. So the <code class="docutils literal"><span class="pre">href</span></code> parameter points to a URL
that loads the complete page while the <code class="docutils literal"><span class="pre">onclick</span></code> parameter provides Javascript
that loads a partial page. An example (using the jQuery Javascript library for
simplification) may help explain that.</p>
<p>Controller:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">c</span><span class="o">.</span><span class="n">employees</span> <span class="o">=</span> <span class="n">webhelpers</span><span class="o">.</span><span class="n">paginate</span><span class="o">.</span><span class="n">Page</span><span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Employee</span><span class="p">),</span>
        <span class="n">page</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&#39;page&#39;</span><span class="p">]),</span>
        <span class="n">items_per_page</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">&#39;partial&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
        <span class="c"># Render the partial page</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="s">&#39;/employees/list-partial.mako&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Render the full page</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="s">&#39;/employees/list-full.mako&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Template <code class="docutils literal"><span class="pre">list-full.mako</span></code>:</p>
<div class="highlight-mako"><div class="highlight"><pre><span class="x">&lt;html&gt;</span>
<span class="x">    &lt;head&gt;</span>
<span class="x">        </span><span class="cp">${</span><span class="n">webhelpers</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">javascript_link</span><span class="p">(</span><span class="s">&#39;/public/jQuery.js&#39;</span><span class="p">)</span><span class="cp">}</span><span class="x"></span>
<span class="x">    &lt;/head&gt;</span>
<span class="x">    &lt;body&gt;</span>
<span class="x">        &lt;div id=&quot;page-area&quot;&gt;</span>
<span class="x">            </span><span class="cp">&lt;%</span><span class="nb">include</span> <span class="na">file=</span><span class="s">&quot;list-partial.mako&quot;</span><span class="cp">/&gt;</span><span class="x"></span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</pre></div>
</div>
<p>Template <code class="docutils literal"><span class="pre">list-partial.mako</span></code>:</p>
<div class="highlight-mako"><div class="highlight"><pre><span class="x">${c.employees.pager(</span>
<span class="x">    &#39;Page $page: $link_previous $link_next ~4~&#39;,</span>
<span class="x">    onclick=&quot;$(&#39;#my-page-area&#39;).load(&#39;%s&#39;); return false;&quot;)}</span>
<span class="x">&lt;ul&gt;</span>
<span class="cp">%</span> <span class="k">for</span> <span class="n">employee</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">employees</span><span class="p">:</span><span class="x"></span>
<span class="x">    &lt;li&gt;</span><span class="cp">${</span><span class="n">employee</span><span class="o">.</span><span class="n">first_name</span><span class="cp">}</span><span class="x"> </span><span class="cp">${</span><span class="n">employee</span><span class="o">.</span><span class="n">last_name</span><span class="cp">}</span><span class="x">&lt;/li&gt;</span>
<span class="cp">%</span><span class="k"> endfor</span><span class="x"></span>
<span class="x">&lt;/ul&gt;</span>
</pre></div>
</div>
<p>To avoid code duplication in the template the full template includes the partial
template. If a partial page load is requested then just the
<code class="docutils literal"><span class="pre">list-partial.mako</span></code> gets rendered. And if a full page load is requested then
the <code class="docutils literal"><span class="pre">list-full.mako</span></code> is rendered which in turn includes the
<code class="docutils literal"><span class="pre">list-partial.mako</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">%s</span></code> variable in the <code class="docutils literal"><span class="pre">onclick</span></code> string gets replaced with a URL pointing
to the respective page with a <code class="docutils literal"><span class="pre">partial=1</span></code> added (the name of the parameter can be customized through the <code class="docutils literal"><span class="pre">partial_param</span></code> parameter). Example:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">href</span></code> parameter points to <code class="docutils literal"><span class="pre">/employees/list?page=3</span></code></li>
<li><code class="docutils literal"><span class="pre">onclick</span></code> parameter contains Javascript loading
<code class="docutils literal"><span class="pre">/employees/list?page=3&amp;partial=1</span></code></li>
</ul>
<p>jQuery&#8217;s syntax to load a URL into a certain DOM object (e.g. a DIV) is simply:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#some-id&#39;</span><span class="p">).</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;/the/url&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The advantage of this technique is that it degrades gracefully. If the user does
not have Javascript enabled then a full page is loaded. And if Javascript works
then a partial load is done through the <code class="docutils literal"><span class="pre">onclick</span></code> action.</p>
</div>
</div>
<div class="section" id="secure-form-tag-helpers">
<span id="secure-forms"></span><h2>Secure Form Tag Helpers<a class="headerlink" href="#secure-form-tag-helpers" title="Permalink to this headline">¶</a></h2>
<p>For prevention of Cross-site request forgery (CSRF) attacks.</p>
<p>Generates form tags that include client-specific authorization tokens to be
verified by the destined web app.</p>
<p>Authorization tokens are stored in the client&#8217;s session. The web app can then
verify the request&#8217;s submitted authorization token with the value in the
client&#8217;s session.</p>
<p>This ensures the request came from the originating page. See the wikipedia entry
for <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request forgery</a> for more information.</p>
<p>Pylons provides an <code class="docutils literal"><span class="pre">authenticate_form</span></code> decorator that does this verification
on the behalf of controllers.</p>
<p>These helpers depend on Pylons&#8217; <code class="docutils literal"><span class="pre">session</span></code> object.  Most of them can be easily
ported to another framework by changing the API calls.</p>
<p>The helpers are implemented in such a way that it should be easy for developers
to create their own helpers if using helpers for AJAX calls.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">authentication_token()</span></code> returns the current authentication token, creating one
and storing it in the session if it doesn&#8217;t already exist.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">auth_token_hidden_field()</span></code> creates a hidden field containing the authentication token.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">secure_form()</span></code> is <code class="xref py py-func docutils literal"><span class="pre">form()</span></code> plus <code class="xref py py-func docutils literal"><span class="pre">auth_token_hidden_field()</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Helpers</a><ul>
<li><a class="reference internal" href="#pagination">Pagination</a><ul>
<li><a class="reference internal" href="#purpose-of-a-paginator">Purpose of a paginator</a></li>
<li><a class="reference internal" href="#the-page-class">The <code class="docutils literal"><span class="pre">Page</span></code> class</a></li>
<li><a class="reference internal" href="#switching-between-pages-using-a-pager">Switching between pages using a <cite>pager</cite></a></li>
<li><a class="reference internal" href="#paging-over-an-sqlalchemy-query">Paging over an SQLAlchemy query</a></li>
<li><a class="reference internal" href="#paging-over-an-sqlalchemy-select">Paging over an SQLAlchemy select</a></li>
<li><a class="reference internal" href="#usage-in-a-pylons-controller-and-template">Usage in a Pylons controller and template</a></li>
<li><a class="reference internal" href="#partial-updates-with-ajax">Partial updates with AJAX</a></li>
</ul>
</li>
<li><a class="reference internal" href="#secure-form-tag-helpers">Secure Form Tag Helpers</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="logging.html"
                        title="previous chapter">Logging</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="forms.html"
                        title="next chapter">Forms</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="forms.html" title="Forms"
             >next</a> |</li>
        <li class="right" >
          <a href="logging.html" title="Logging"
             >previous</a> |</li>
    	<li><a href="index.html">Pylons Framework 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2008-2011, Ben Bangert, James Gardner, Philip Jenvey.
      Last updated on Jun 10, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>